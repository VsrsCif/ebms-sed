<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:sui="http://java.sun.com/jsf/composite/sed-ui"
      >

    <h:head>
        <title>SED User GUI</title>
        <link href="resources/css/main.css" rel="stylesheet" />
        <link href="resources/css/icons.css" rel="stylesheet" />

    </h:head>

    <h:body>
        <h:form id="forms" >

            <p:growl id="messages" showDetail="true" />
            <!-- main window -->    
            <p:layout style="min-width:400px;min-height:400px;"  fullPage="true"  >
                <!-- toolbar -->    
                <p:layoutUnit position="north" resizable="false" gutter="0" style="padding: 0px; margin: 0px" >

                    <p:toolbar style="padding: 0px; margin: 0px; height: 28px; vertical-align: middle;">
                        <f:facet name="left">
                            <p:commandButton id="btnExit"  
                                             value="Exit" 
                                             icon="ui-icon-sed-exit"
                                             actionListener="#{loginManager.logout()}"
                                             styleClass="toolbar-Button"/>
                            <p:commandButton id="btnRefresh"  
                                             value="Refresh" 
                                             icon="ui-icon-sed-refresh"
                                             styleClass="toolbar-Button"
                                             actionListener="#{ApplicationData.refreshMainPanel()}" />


                            <span class="ui-separator">
                                <span class="ui-icon ui-icon-grip-dotted-vertical " />
                            </span>
                            <p:commandButton value="Resend" styleClass="toolbar-Button" />
                            <p:commandButton value="Delete" styleClass="toolbar-Button" />
                        </f:facet>

                        <f:facet name="right"  >

                            <p:outputLabel value="User:" /> <b>#{userSessionData.user.userId}</b>
                            <span class="ui-separator">
                                <span class="ui-icon ui-icon-grip-dotted-vertical " />
                            </span>
                            <p:outputLabel for="ebox" value="SED-Box: " />
                            <p:selectOneMenu id="ebox" value="#{userSessionData.currentSEDBox}" style="width:150px">
                                <f:selectItem itemValue="" noSelectionOption="false" />
                                <f:selectItems value="#{userSessionData.userEBoxes}" />
                            </p:selectOneMenu>

                        </f:facet>

                    </p:toolbar>
                </p:layoutUnit>
                <p:layoutUnit  position="center"  gutter="0" >

                    <h:panelGroup id="MainPanel">

                        <sui:mail-table-in id="InMailPanel" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_INBOX)  }"  />
                        <sui:mail-table-out id="OutMailPanel" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_OUTBOX)}"  />
                        <sui:settings-keystore id="SettingsCustomPanel" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_SETT_CERTS)}"  />
                        <sui:settings-custom id="SettingsCertPanel" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_SETT_CUSTOM)}"  />
                        <sui:settings-pmode id="SettingsPModes" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_SETT_PMODE)}"  />                        
                        <sui:settings-users id="SettingsUsers" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_ADMIN_USERS)}"  />
                        <sui:settings-eboxes id="SettingsSEDBoxes" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_ADMIN_EBOXES)}"  />
                        <sui:settings-cron id="SettingsCron" rendered="#{MainWindow.currentPanel().equalsIgnoreCase(AppConstant.s_PANEL_ADMIN_CRON)}"  />
                    </h:panelGroup>
                </p:layoutUnit>
                <p:layoutUnit position="south" resizable="false" size="20" minSize="20" maxSize="200">

                </p:layoutUnit>
                <p:layoutUnit position="west" resizable="false" size="250" minSize="250" maxSize="250">
                    <p:accordionPanel  >
                        <p:ajax event="tabChange" listener="#{MainWindow.onToolbarTabChange}" update="forms:MainPanel" />
                        <p:tab id="PANEL_INBOX" >
                            <f:facet name="title">
                                <h:graphicImage value="resources/images/inbox32.png" width="22" height="22" />
                                <h:outputText value="Inbox" />                                 
                            </f:facet>

                            <p:menu class="ui-accordion-button">
                                <p:menuitem value="All mail"  actionListener="#{InMailDataView.search}"  update="forms:InMailPanel" icon="ui-icon-sed-flag-all">
                                    <f:attribute name="status" value="" />
                                </p:menuitem>
                                <p:menuitem value="Received mail" actionListener="#{InMailDataView.search}" update="forms:InMailPanel" icon="ui-icon-sed-flag-green">
                                    <f:attribute name="status" value="RECEIVED" />
                                </p:menuitem>
                                <p:menuitem value="Locked mail" actionListener="#{InMailDataView.search}"  update="forms:InMailPanel" icon="ui-icon-sed-flag-gray">
                                    <f:attribute name="status" value="LOCKED" />
                                </p:menuitem>
                                <p:menuitem value="Error mail" actionListener="#{InMailDataView.search}" update="forms:InMailPanel" icon="ui-icon-sed-flag-red">
                                    <f:attribute name="status" value="ERROR" />
                                </p:menuitem>
                                <p:menuitem value="Delivered" actionListener="#{InMailDataView.search}"  update="forms:InMailPanel" icon="ui-icon-sed-flag-blue">
                                    <f:attribute name="status" value="DELIVERED" />
                                </p:menuitem>
                            </p:menu>


                        </p:tab>
                        <p:tab id="PANEL_OUTBOX">
                            <f:facet name="title">
                                <h:graphicImage value="resources/images/outbox32.png" width="22" height="22" />
                                <h:outputText value="Outbox" />                                 
                            </f:facet>
                            <p:menu class="ui-accordion-button">
                                <p:menuitem value="All mail"  actionListener="#{OutMailDataView.search}"  update="forms:InMailPanel" icon="ui-icon-sed-flag-all">
                                    <f:attribute name="status" value="" />
                                </p:menuitem>
                                <p:menuitem value="Submited" actionListener="#{OutMailDataView.search}" update="forms:InMailPanel" icon="ui-icon-sed-flag-green">
                                    <f:attribute name="status" value="RECEIVED" />
                                </p:menuitem>
                                <p:menuitem value="In delivery" actionListener="#{OutMailDataView.search}"  update="forms:InMailPanel"  icon="ui-icon-sed-flag-gray">
                                    <f:attribute name="status" value="LOCKED" />
                                </p:menuitem>
                                <p:menuitem value="Error" actionListener="#{OutMailDataView.search}" update="forms:InMailPanel"  icon="ui-icon-sed-flag-red">
                                    <f:attribute name="status" value="ERROR" />
                                </p:menuitem>
                                <p:menuitem value="Delivered" actionListener="#{OutMailDataView.search}"  update="forms:InMailPanel" icon="ui-icon-sed-flag-blue">
                                    <f:attribute name="status" value="DELIVERED" />
                                </p:menuitem>
                            </p:menu>
                        </p:tab>

                        <!-- p:tab id="PANEL_SETT_PMODE">
                            <f:facet name="title">
                                <h:graphicImage value="resources/images/settings32.png" width="22" height="22" />
                                <h:outputText value="P-Modes" />                                 
                            </f:facet>
                            <p:dataTable var="pmd" value="#{PModeView.PModes}" 
                                         selectionMode="single" 
                                         selection="#{PModeView.currentPMode}" 
                                         rowKey="#{pmd.id}">
                                <p:ajax event="rowSelect" listener="#{PModeView.onRowSelect}" 
                                        update="forms:SettingsPModes:PModePanel" />  

                                <p:column headerText="ID">
                                    <h:outputText value="#{pmd.id}" />
                                </p:column>
                                <p:column headerText="Is template ">
                                    <h:outputText value="#{pmd.isTemplate}" />
                                </p:column>

                            </p:dataTable>

                        </p:tab -->

                        <p:tab id="PANEL_SETT_CUSTOM">
                            <f:facet name="title">
                                <h:graphicImage value="resources/images/settings32.png" width="22" height="22" />
                                <h:outputText value="Settings" />                                 
                            </f:facet>
                            <p:menu class="ui-accordion-button">
                                <p:menuitem value="Custom"  actionListener="#{MainWindow.onToolbarButtonAction}"  update="forms:MainPanel">
                                    <f:attribute name="panel" value="PANEL_SETT_CUSTOM" />
                                </p:menuitem>
                                <p:menuitem value="Certificates"  actionListener="#{MainWindow.onToolbarButtonAction}"  update="forms:MainPanel">
                                    <f:attribute name="panel" value="PANEL_SETT_CERTS" />
                                </p:menuitem>
                                <p:menuitem value="Users"  actionListener="#{MainWindow.onToolbarButtonAction}"  update="forms:MainPanel">
                                    <f:attribute name="panel" value="PANEL_ADMIN_USERS" />
                                </p:menuitem>
                                <p:menuitem value="SED-Boxes"  actionListener="#{MainWindow.onToolbarButtonAction}"  update="forms:MainPanel">
                                    <f:attribute name="panel" value="PANEL_ADMIN_EBOXES" />
                                </p:menuitem>
                                <p:menuitem value="Scheduler"  actionListener="#{MainWindow.onToolbarButtonAction}"  update="forms:MainPanel">
                                    <f:attribute name="panel" value="PANEL_ADMIN_CRON" />
                                </p:menuitem>
                            </p:menu>

                        </p:tab>

                    </p:accordionPanel>
                </p:layoutUnit>
            </p:layout>

            <p:dialog  header="SEDBox detail" widgetVar="sedboxDialog" modal="true" hideEffect="fade" resizable="true">
                <p:layout id="sedboxDialog" style="min-width:400px;min-height:200px;">
                    <p:layoutUnit position="center" rendered="#{empty adminSEDBoxView.editableSedBox}" >
                        <h:outputText value="Select row in table" />
                    </p:layoutUnit>
                    <p:layoutUnit position="center" rendered="#{not empty adminSEDBoxView.editableSedBox}" >
                        <p:panelGrid  columns="2" columnClasses="label,value">

                            <h:outputText value="Box:" />
                            <h:outputText value="#{adminSEDBoxView.editableSedBox.boxName}" rendered="#{not adminSEDBoxView.currentIsNew}" />
                            <h:inputText value="#{adminSEDBoxView.editableSedBox.boxName}" rendered="#{adminSEDBoxView.currentIsNew}" />

                            <h:outputText value="Active from date:" />                                                        
                            <p:calendar  value="#{adminSEDBoxView.editableSedBox.activeFromDate}" pattern="dd.MM.yyyy" mask="true" navigator="true" showOn="button"/>

                            <h:outputText value="Active to date:" />                            
                            <p:calendar value="#{adminSEDBoxView.editableSedBox.activeToDate}" pattern="dd.MM.yyyy" mask="true" navigator="true" showOn="button"/>
                        </p:panelGrid>
                    </p:layoutUnit>
                    <p:layoutUnit position="south">
                        <p:commandButton value="Ok" update=":forms:SettingsSEDBoxes:TblSedBox" styleClass="toolbar-Button" icon="ui-icon-sed-ok" 
                                         actionListener="#{adminSEDBoxView.updateOrAddSEDBox()}"
                                         oncomplete="PF('sedboxDialog').hide()"   />
                        <p:commandButton value="Cancel" update=":forms:sedboxDialog" styleClass="toolbar-Button" icon="ui-icon-sed-cancel" oncomplete="PF('sedboxDialog').hide()" />
                    </p:layoutUnit>
                </p:layout>
            </p:dialog>


            <p:dialog  header="SEDCron detail" widgetVar="cronDialog" modal="true" hideEffect="fade" resizable="true">
                <p:layout id="cronDialog" style="min-width:600px;min-height:200px;">
                    <p:layoutUnit position="center" rendered="#{empty adminMSHCronJobView.editableMSHCronJob}" >
                        <h:outputText value="Select row in table" />
                    </p:layoutUnit>
                    <p:layoutUnit position="west" rendered="#{not empty adminMSHCronJobView.editableMSHCronJob}" >
                        <p:panelGrid  columns="2" columnClasses="label,value">

                            <h:outputText value="Minute:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMSHCronJob.minute}"  />

                            <h:outputText value="Hour:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMSHCronJob.hour}"  />

                            <h:outputText value="Day of Month:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMSHCronJob.dayOfMonth}"  />

                            <h:outputText value="Month:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMSHCronJob.month}"  />

                            <h:outputText value="Day of week:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMSHCronJob.dayOfWeek}"  />

                       

                        </p:panelGrid>


                    </p:layoutUnit>
                     <p:layoutUnit position="center" rendered="#{not empty adminMSHCronJobView.editableMSHCronJob}" >
                        <p:panelGrid  columns="2" columnClasses="label,value">
                            <h:outputText value="Task:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMSHCronJob.MSHTask.taskType}"  />
                            
                            <h:outputText value="Mail address:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMail}"  />
                            <h:outputText value="Mail subject:" />
                            <h:inputText value="#{adminMSHCronJobView.editableMailSubject}"  />
                        </p:panelGrid>


                    </p:layoutUnit>
                    <p:layoutUnit position="south">
                        <p:commandButton value="Ok" update=":forms:SettingsCron:TblCron" styleClass="toolbar-Button" icon="ui-icon-sed-ok" 
                                         actionListener="#{adminMSHCronJobView.updateOrAddMSHCronJob()}"
                                         oncomplete="PF('cronDialog').hide()"   />
                        <p:commandButton value="Cancel" update=":forms:cronDialog" styleClass="toolbar-Button" icon="ui-icon-sed-cancel" oncomplete="PF('cronDialog').hide()" />
                    </p:layoutUnit>
                </p:layout>
            </p:dialog>

            <p:dialog   header="SEDUser detail" widgetVar="userDialog" modal="true" hideEffect="fade" resizable="true">
                <p:layout  id="userDialog" style="min-width:450px;min-height:380px;">
                    <p:layoutUnit position="center" rendered="#{empty adminSEDUserView.editableSedUser}" >
                        <h:outputText value="Select row in table" />
                    </p:layoutUnit>
                    <p:layoutUnit position="center" rendered="#{not empty adminSEDUserView.editableSedUser}" >
                        <p:panelGrid >

                            <p:row>
                                <p:column><h:outputText value="Username:" /></p:column>
                                <p:column><h:outputText value="#{adminSEDUserView.editableSedUser.userId}" rendered="#{not adminSEDUserView.currentIsNew}" />
                                    <h:inputText value="#{adminSEDUserView.editableSedUser.userId}" rendered="#{adminSEDUserView.currentIsNew}" /></p:column>
                            </p:row>
                            <p:row>
                                <p:column><h:outputText value="Active from date:" /></p:column>
                                <p:column><p:calendar value="#{adminSEDUserView.editableSedUser.activeFromDate}" pattern="dd.MM.yyyy" mask="true" navigator="true" showOn="button"/></p:column>
                            </p:row>
                            <p:row>
                                <p:column><h:outputText value="Active to date:" /></p:column>
                                <p:column><p:calendar value="#{adminSEDUserView.editableSedUser.activeToDate}" pattern="dd.MM.yyyy" mask="true" navigator="true" showOn="button"/></p:column>
                            </p:row>
                            <p:row>
                                <p:column colspan="2" >

                                    <p:pickList id="UserBoxPickList" value="#{adminSEDUserView.currentPickupDualSEDBoxList}" var="sbox" 
                                                effect="fade"
                                                itemValue="#{sbox}" itemLabel="#{sbox.boxName}" showSourceControls="false"
                                                showTargetControls="false" showCheckbox="false" responsive="true"
                                                showSourceFilter="false" showTargetFilter="false" converter="primeFacesPickListConverter"
                                                >
                                        <f:facet name="sourceCaption">Available</f:facet>
                                        <f:facet name="targetCaption">User sed-boxes</f:facet>



                                        <p:column >
                                            <h:outputText value="#{sbox.boxName}" />
                                        </p:column>
                                    </p:pickList>


                                </p:column>
                            </p:row>
                        </p:panelGrid>
                    </p:layoutUnit>
                    <p:layoutUnit position="south">
                        <p:commandButton value="Ok" update=":forms:SettingsUsers:TblSedUser" styleClass="toolbar-Button" icon="ui-icon-sed-ok" 
                                         actionListener="#{adminSEDUserView.updateOrAddSEDUser()}"
                                         oncomplete="PF('userDialog').hide()"   />
                        <p:commandButton value="Cancel" update=":forms:sedboxDialog" styleClass="toolbar-Button" icon="ui-icon-sed-cancel" oncomplete="PF('userDialog').hide()" />
                    </p:layoutUnit>
                </p:layout>
            </p:dialog>

        </h:form>
    </h:body>
</html>